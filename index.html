
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <title>Calculador de Agua Diaria</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
</head>
<body>
    <div class="container" id="primeira-pagina">
        <h1>Calculadora de Agua Diaria teste</h1>
        <small id="branch">BRANCH PRODUCAO</small>
        <p>digite o seu peso e veja a quantidade de agua que voce deve 
           tomar por dia</p>

        <label for="peso">Qual seu nome :</label>
        <input type="nome" id="nome" min="0" step="0.01"><br>
        <label for="peso">Qual seu Peso (em kg):</label>
        <input type="number" id="peso" min="0" step="0.01"><br>

        <p id="resultado"></p>

        <button type="button" onclick="calcularAgua()">Calcular</button>
        <button type="button" onclick="nextPage()">listar</button>
    </div>

    <script>

        function nextPage() {
            window.location.href = "./registros.html"
        }

        function calcularAgua() {

            const peso = parseFloat(document.getElementById('peso').value);

            // Valor médio recomendado é de 30 a 35 ml de água por kg de peso
            const quantidadeRecomendadaMl = peso * 35;
            const quantidadeRecomendadaL = (quantidadeRecomendadaMl / 1000).toFixed(2);

            const nome = document.getElementById("nome").value

            document.getElementById("resultado").innerHTML = `${nome}, você deve tomar ${quantidadeRecomendadaL} litros por dia`

            
            cadastrarNoBancoDeDados(nome, quantidadeRecomendadaL)
        }


        function cadastrarNoBancoDeDados(nome, quant) {

            const urlApi = "http://api.producao.192.168.49.2.nip.io/cadastrar"

        // Dados a serem enviados no corpo da solicitação
        const dadosCadastro = {
            name: nome,
            quantAgua: quant
        };

        // Opções da solicitação, incluindo o método, cabeçalhos e corpo
        const opcoesCadastro = {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json', // Tipo de conteúdo: JSON
            },
            body: JSON.stringify(dadosCadastro) // Converte os dados em JSON
        };

        // Envia a solicitação de cadastro para o backend
        fetch(urlApi, opcoesCadastro)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Erro na solicitacao');
                }
                return response.json(); // Analisa a resposta como JSON
            })
            .then(data => {
                console.log('Dados cadastrados com sucesso:', data);
            })
            .catch(error => {
                console.error('Erro no cadastro:', error);
            });
}

    </script>
</body>
</html>
